var app=angular.module("app",["ngTouch","ui.grid","ngSanitize"]),Pr,WO;app.factory("projectControlService",function(n){var t={};return t.GetWorkOrder=function(){return n({method:"GET",dataType:"jsonp",url:"api/projectControl/getWorkOrder"})},t.GetProjectStatus=function(){return n({method:"GET",dataType:"jsonp",url:"api/projectControl/getProjectStatus"})},t.GetTypeRequest=function(){return n({method:"GET",dataType:"jsonp",url:"api/projectControl/getTypeRequest"})},t});app.controller("GridCtrl",function(n,t,i){n.alertType="info";n.loadigMessage="<p>Loading data, please wait...!<\/p>";n.GetProjects=function(){n.typeRequest=null;n.projectStatus=null;n.dataLoaded=!1;n.gridOptions={onRegisterApi:function(t){n.gridApi=t;n.gridApi.grid.registerRowsProcessor(n.searchFilter,1e4)},columnDefs:[{field:"projectName",name:"Project"},{field:"idTypeRequest",name:"Request Type",cellFilter:"getTypeRequest:grid.appScope.typeRequest"},{field:"date",type:"date",cellFilter:"date:'MMM dd yyyy'"},{field:"prodigiousPM",name:"Prodigious PM"},{field:"idProjectStatus",name:"Status",cellFilter:"getStatusType:grid.appScope.projectStatus"},{name:"View",width:100,cellTemplate:'<div class="ui-grid-cell-contents"><a href="/workorder/view/{{ row.entity.uniqueId }}/{{ row.entity.secureCode }}"><i class="fa fa-link"><\/i><\/a><\/div>'},{name:"Update",width:100,cellTemplate:'<div class="ui-grid-cell-contents grid-update"><a href="/workorder/update/{{ row.entity.uniqueId }}/{{ row.entity.secureCode }}"><i class="fa fa-edit"><\/i><\/a><\/div>'}]};i.GetTypeRequest().then(function(t){n.typeRequest=[];var i=t.data;i.forEach(function(t){n.typeRequest[t.uniqueId]=t.request})},function(){n.loadigMessage==="<p>Loading data, please wait...!<\/p>"&&(n.loadigMessage="");n.alertType="danger";n.loadigMessage=n.loadigMessage+"<p>Error loading TypeRequest Table from the Data Base. <strong>Please check the Data Base connection<\/strong><\/p>"});i.GetProjectStatus().then(function(t){n.projectStatus=[];var i=t.data;i.forEach(function(t){n.projectStatus[t.uniqueId]=t.status})},function(){n.loadigMessage==="<p>Loading data, please wait...!<\/p>"&&(n.loadigMessage="");n.alertType="danger";n.loadigMessage=n.loadigMessage+"<p>Error loading ProjectStatus Table from the Data Base. <strong>Please check the Data Base connection<\/strong><\/p>"});i.GetWorkOrder().then(function(t){n.dataLoaded=!0;n.gridOptions.data=t.data},function(){n.loadigMessage==="<p>Loading data, please wait...!<\/p>"&&(n.loadigMessage="");n.alertType="danger";n.loadigMessage=n.loadigMessage+"<p>Error loading WorkOrder Table from the Data Base. <strong>Please check the Data Base connection<\/strong><\/p>"})};n.GetProjects()}).filter("getTypeRequest",function(){return function(n,t){return t[n]}}).filter("getStatusType",function(){return function(n,t){return t[n]}});Pr=Pr||{};Pr.preferences={moveItems:function(n,t){$(n).find(":selected").appendTo(t)},moveAllItems:function(n,t){$(n).children().appendTo(t)},init:function(){$("#left").click(function(){Pr.preferences.moveItems("#assetsDestination","#assetsOring")});$("#right").on("click",function(){Pr.preferences.moveItems("#assetsOring","#assetsDestination")})}};Pr.preferences.init();Pr.form={init:function(){alert("Preferences updated!")}};Pr.SelectedIndexChanged={init:function(){var n=$("#TypeRequest :selected").text();alert("On changed!"+n)}};WO=WO||{};WO.domainBtn={init:function(){var n=$("#domains-inputs"),r=$("#btn-domains"),t=$("#newDomain"),i=n.data("count");$(r).click(function(r){r.preventDefault();$(n).append('<div><input name="Domains['+i+'].domain1" type="text" class="form-control" placeholder="URL" value="'+t.val()+'" /><\/div>');t.val("");i++})}};WO.domainBtn.init();WO.urlAffectedBtn={init:function(){var n=$("#urlAffected-inputs"),r=$("#btn-urlAffected"),t=$("#newUrlAffected"),i=n.data("count");$(r).click(function(r){r.preventDefault();$(n).append('<div><input name="EffectedUrls['+i+'].url" type="text" class="form-control" placeholder="URL" value="'+t.val()+'" /><\/div>');t.val("");i++})}};WO.urlAffectedBtn.init();WO.thirdPartyURL={init:function(){var t=$("#thirdParty-inputs"),f=$("#btn-thirdParty"),i=$("#newThirdPartyUrl"),r=$("#newThirdPartyUser"),u=$("#newThirdPartyPass"),n=t.data("count");$(f).click(function(f){f.preventDefault();var e='<div><input name="ThirdPartyCredential['+n+'].url" type="text" class="form-control" placeholder="URL" value="'+i.val()+'" />';e+='<input name="ThirdPartyCredential['+n+'].userName" type="text" class="form-control" placeholder="User" value="'+r.val()+'" />';e+='<input name="ThirdPartyCredential['+n+'].password" type="text" class="form-control" placeholder="Password" value="'+u.val()+'" /><\/div>';$(t).append(e);i.val("");r.val("");u.val("");n++})}};WO.thirdPartyURL.init();WO.OnSuccess={init:function(){$("html, body").animate({scrollTop:0},"fast");$("#workOrderResult").removeClass("hide")}};WO.OnComplete={init:function(n){var t=n.context.ownerDocument.activeElement.value,i=n.context.baseURI.replace("update","generatepdf");t==="ExportPdf"&&(window.location.href=i)}};